<% if request.variant.any?(:mini_program) %>
  <div
    data-controller="mini-program"
    data-mini-program-direct-value="true"
    data-mini-program-url-value="/pages/wxpay_pay/index"
    data-mini-program-data-value="<%=
      {
        url: url_for(controller: 'payments', action: 'wxpay', order_id: @order.id, only_path: false),
        path: url_for(action: 'payment_types', id: @order.id, only_path: false),
        path_fail: url_for(action: 'payment_types', id: @order.id, only_path: false)
      }.to_json
    %>"
  ></div>
<% elsif @wxpay_order && @wxpay_order[:package].present? %>
  <div
    data-controller="wxpay"
    data-wxpay-options-value="<%= current_wechat_user.app.js_config(session[:enter_url]).to_json %>"
    data-wxpay-params-value="<%= @wxpay_order.slice(:timeStamp, :nonceStr, :package, :signType, :paySign, :appId).to_json %>"
    data-wxpay-auto-value="true"
  ></div>
<% end %>
